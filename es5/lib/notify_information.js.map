{"version":3,"sources":["lib/notify_information.js"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA;;;;IAEa,wB,WAAA,wB;;;;;;;0BACL,M,EAAQ;AACZ,aAAO,UAAP,CAAkB,6BAAlB,EAAiD,UAAC,MAAD,EAAY;AAC3D,eAAO,KAAP,CAAa,aAAb,EAA4B,wBAA5B,EAAsD,YAAtD;AACD,OAFD;AAGD;;;;;IAGU,2B,WAAA,2B;;;AACX,uCAAY,MAAZ,EAAoB;AAAA;AAAA,gIACZ,MADY;AAEnB;;;;;;;;;;;uBAGO,KAAK,cAAL,E;;;;uBACA,KAAK,cAAL,E;;;;uBACA,KAAK,eAAL,E;;;;uBACA,KAAK,UAAL,E;;;;uBACA,KAAK,cAAL,E;;;;uBACA,KAAK,gBAAL,E;;;;uBACA,KAAK,gBAAL,E;;;;uBACA,KAAK,mBAAL,E;;;;uBACA,KAAK,iBAAL,E;;;;uBACA,KAAK,gBAAL,E;;;;uBACA,KAAK,mBAAL,E;;;;uBACA,KAAK,mBAAL,E;;;;uBACA,KAAK,aAAL,E;;;;uBACA,KAAK,eAAL,E;;;;uBACA,KAAK,kBAAL,E;;;;uBACA,KAAK,oBAAL,E;;;;uBACA,KAAK,kBAAL,E;;;;uBACA,KAAK,cAAL,E;;;;uBACA,KAAK,QAAL,E;;;AACN,qBAAK,MAAL,CAAY,IAAZ,CAAiB,0BAAjB;;;;;;;;;;;;;;;;;;qCAGe;AACf,aAAO,KAAK,MAAL,CAAY,UAAZ,CAAuB,OAAvB,CAA+B,OAA/B,CAAuC,gBAAvC,EAAyD,CAAC,KAAK,MAAL,CAAY,aAAZ,CAA0B,IAA3B,CAAzD,CAAP;AACD;;;qCAEgB;;AAEf,UAAM,qBAAqB,KAAK,MAAL,CAAY,UAAZ,CAAuB,kBAAlD;AACA,UAAM,QAAQ,mBAAmB,QAAnB,CACX,GADW,CACP,UAAC,OAAD;AAAA,eAAa,mBAAmB,MAAnB,CAA0B,OAA1B,CAAb;AAAA,OADO,EAEX,MAFW,CAEJ,UAAC,MAAD;AAAA,eAAY,OAAO,aAAnB;AAAA,OAFI,EAGX,GAHW,CAGP,UAAC,MAAD;AAAA,eAAY,CACf,OAAO,aAAP,CAAqB,IADN,EAEf,OAAO,KAAP,CAAa,MAAb,CAAoB,CAApB,EAAuB,OAAvB,GAAiC,SAFlB,EAGf,OAAO,KAAP,CAAa,MAAb,CAAoB,CAApB,IAAyB,OAAO,KAAP,CAAa,MAAb,CAAoB,CAApB,EAAuB,OAAvB,GAAiC,SAA1D,GAAsE,EAHvD,EAIf,IAJe,CAIV,QAJU,CAAZ;AAAA,OAHO,CAAd;AAQA,aAAO,KAAK,MAAL,CAAY,UAAZ,CAAuB,OAAvB,CAA+B,OAA/B,CAAuC,gBAAvC,EAAyD,CAAC,KAAD,CAAzD,CAAP;AACD;;;sCAEiB;;AAEhB,aAAO,KAAK,MAAL,CAAY,UAAZ,CAAuB,OAAvB,CAA+B,OAA/B,CAAuC,iBAAvC,EAA0D,CAAC,OAAD,EAAU,SAAV,CAA1D,CAAP;AACD;;;iCAEY;AACX,aAAO,KAAK,MAAL,CAAY,UAAZ,CAAuB,OAAvB,CAA+B,OAA/B,CAAuC,YAAvC,EAAqD,CAC1D,yBAD0D,CAArD,CAAP;AAGD;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;uCAWkB;;AAEjB,aAAO,KAAK,MAAL,CAAY,UAAZ,CAAuB,OAAvB,CAA+B,OAA/B,CAAuC,kBAAvC,EAA2D,CAChE,KAAK,MAAL,CAAY,aAAZ,CAA0B,IADsC,EAEhE,KAAK,MAAL,CAAY,aAAZ,CAA0B,aAA1B,CAFgE,EAGhE,KAAK,MAAL,CAAY,aAAZ,CAA0B,WAA1B,CAHgE,EAIhE,KAAK,MAAL,CAAY,aAAZ,CAA0B,MAA1B,CAJgE,EAKhE,IALgE,EAMhE,KAAK,MAAL,CAAY,eAAZ,CAA4B,MAA5B,CANgE,EAOhE,IAPgE,CAA3D,CAAP;AASD;;;0CAEqB;;AAEpB,aAAO,KAAK,MAAL,CAAY,UAAZ,CAAuB,OAAvB,CAA+B,OAA/B,CAAuC,qBAAvC,EAA8D,CACnE,KAAK,MAAL,CAAY,eAAZ,CAA4B,MAA5B,CADmE,EAEnE,IAFmE,EAGnE,IAHmE,CAA9D,CAAP;AAKD;;;wCAEmB;;AAElB,aAAO,KAAK,MAAL,CAAY,UAAZ,CAAuB,OAAvB,CAA+B,OAA/B,CAAuC,mBAAvC,EAA4D,CACjE,KAAK,MAAL,CAAY,aAAZ,CAA0B,MAA1B,CADiE,EAEjE,IAFiE,EAGjE,IAHiE,CAA5D,CAAP;AAKD;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;0CAUqB;;AAErB;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;YAWO,K;;;;;;uBAAc,KAAK,MAAL,CAAY,UAAZ,CAAuB,aAAvB,CAAqC,WAArC,E;;;AAAd,qB;kDACC,KAAK,MAAL,CAAY,UAAZ,CAAuB,OAAvB,CAA+B,OAA/B,CAAuC,oBAAvC,EAA6D,KAA7D,C;;;;;;;;;;;;;;;;;;;;YAID,K;;;;;;uBAAc,KAAK,MAAL,CAAY,UAAZ,CAAuB,aAAvB,CAAqC,aAArC,E;;;AAAd,qB;kDACC,KAAK,MAAL,CAAY,UAAZ,CAAuB,OAAvB,CAA+B,OAA/B,CAAuC,sBAAvC,EAA+D,KAA/D,C;;;;;;;;;;;;;;;;;;;;YAID,K;;;;;;uBAAc,KAAK,MAAL,CAAY,UAAZ,CAAuB,aAAvB,CAAqC,WAArC,CAAiD,KAAK,MAAL,CAAY,OAA7D,C;;;AAAd,qB;mDACC,KAAK,MAAL,CAAY,UAAZ,CAAuB,OAAvB,CAA+B,OAA/B,CAAuC,oBAAvC,EAA6D,KAA7D,C;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAYX,oCAAuB,2BAAvB,GAAqD,2BAArD;AACA,iCAAoB,IAApB,CAAyB,wBAAzB","file":"notify_information.js","sourcesContent":["import {GhostKernelRoutings, GhostKernelControllers, GhostKernelController} from 'ghost-kernel';\r\n\r\nexport class NotifyInformationRouting {\r\n  setup(routes) {\r\n    routes.controller('NotifyInformationController', (routes) => {\r\n      routes.event('GhostKernel', 'protocol_version_fixed', 'initialize');\r\n    });\r\n  }\r\n}\r\n\r\nexport class NotifyInformationController extends GhostKernelController {\r\n  constructor(kernel) {\r\n    super(kernel);\r\n  }\r\n\r\n  async initialize() {\r\n    await this.ownerghostname();\r\n    await this.otherghostname();\r\n    await this.basewareversion();\r\n    await this.capability();\r\n    await this.OnNotifyOSInfo();\r\n    await this.OnNotifyFontInfo();\r\n    await this.OnNotifySelfInfo();\r\n    await this.OnNotifyBalloonInfo();\r\n    await this.OnNotifyShellInfo();\r\n    await this.OnNotifyUserInfo();\r\n    await this.OnNotifyDressupInfo();\r\n    await this.OnNotifyBrowserInfo();\r\n    await this.ghostpathlist();\r\n    await this.balloonpathlist();\r\n    await this.installedghostname();\r\n    await this.installedballoonname();\r\n    await this.installedshellname();\r\n    await this.rateofusegraph();\r\n    await this.uniqueid();\r\n    this.kernel.emit('notify_informations_done');\r\n  }\r\n\r\n  ownerghostname() {\r\n    return this.kernel.components.Shiorif.notify3('ownerghostname', [this.kernel.ghostDescript.name]);\r\n  }\r\n\r\n  otherghostname() {\r\n    // TODO ここでこの実装してよいのか\r\n    const namedKernelManager = this.kernel.components.NamedKernelManager;\r\n    const names = namedKernelManager.namedIds\r\n      .map((namedId) => namedKernelManager.kernel(namedId))\r\n      .filter((kernel) => kernel.ghostDescript)\r\n      .map((kernel) => [\r\n        kernel.ghostDescript.name,\r\n        kernel.Named.scopes[0].surface().surfaceId,\r\n        kernel.Named.scopes[1] ? kernel.Named.scopes[1].surface().surfaceId : '',\r\n      ].join('\\u0001'));\r\n    return this.kernel.components.Shiorif.notify3('otherghostname', [names]);\r\n  }\r\n\r\n  basewareversion() {\r\n    // TODO バージョンとか\r\n    return this.kernel.components.Shiorif.notify3('basewareversion', ['0.1.0', 'Ikagaka']);\r\n  }\r\n\r\n  capability() {\r\n    return this.kernel.components.Shiorif.notify3('capability', [\r\n      'response.requestcharset',\r\n    ]);\r\n  }\r\n\r\n  async OnNotifyOSInfo() {\r\n    // TODO\r\n  }\r\n\r\n  async OnNotifyFontInfo() {\r\n    // TODO\r\n    // https://github.com/Pomax/Font.js or http://www.lalit.org/lab/javascript-css-font-detect/\r\n  }\r\n\r\n  OnNotifySelfInfo() {\r\n    // TODO abs path\r\n    return this.kernel.components.Shiorif.notify3('OnNotifySelfInfo', [\r\n      this.kernel.ghostDescript.name,\r\n      this.kernel.ghostDescript['sakura.name'],\r\n      this.kernel.ghostDescript['kero.name'],\r\n      this.kernel.shellDescript['name'],\r\n      null,\r\n      this.kernel.balloonDescript['name'],\r\n      null,\r\n    ]);\r\n  }\r\n\r\n  OnNotifyBalloonInfo() {\r\n    // TODO\r\n    return this.kernel.components.Shiorif.notify3('OnNotifyBalloonInfo', [\r\n      this.kernel.balloonDescript['name'],\r\n      null,\r\n      null,\r\n    ]);\r\n  }\r\n\r\n  OnNotifyShellInfo() {\r\n    // TODO\r\n    return this.kernel.components.Shiorif.notify3('OnNotifyShellInfo', [\r\n      this.kernel.shellDescript['name'],\r\n      null,\r\n      null,\r\n    ]);\r\n  }\r\n\r\n  async OnNotifyUserInfo() {\r\n    // TODO\r\n  }\r\n\r\n  async OnNotifyDressupInfo() {\r\n    // TODO\r\n  }\r\n\r\n  OnNotifyBrowserInfo() {\r\n    // TODO\r\n  }\r\n\r\n  async ghostpathlist() {\r\n    // TODO\r\n  }\r\n\r\n  async balloonpathlist() {\r\n    // TODO\r\n  }\r\n\r\n  async installedghostname() {\r\n    const names = await this.kernel.components.NanikaStorage.ghost_names();\r\n    return this.kernel.components.Shiorif.notify3('installedghostname', names);\r\n  }\r\n\r\n  async installedballoonname() {\r\n    const names = await this.kernel.components.NanikaStorage.balloon_names();\r\n    return this.kernel.components.Shiorif.notify3('installedballoonname', names);\r\n  }\r\n\r\n  async installedshellname() {\r\n    const names = await this.kernel.components.NanikaStorage.shell_names(this.kernel.namedId);\r\n    return this.kernel.components.Shiorif.notify3('installedshellname', names);\r\n  }\r\n\r\n  async rateofusegraph() {\r\n    // TODO\r\n  }\r\n\r\n  async uniqueid() {\r\n    // TODO\r\n  }\r\n}\r\n\r\nGhostKernelControllers.NotifyInformationController = NotifyInformationController;\r\nGhostKernelRoutings.push(NotifyInformationRouting);\r\n"]}